{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$ref": "#/definitions/AppSetting",
  "definitions": {
    "AppSetting": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "appSettings": {
          "type": "object",
          "properties": {
            "appId": {
              "type": "string",
              "description": "The appId of your GitHub App."
            },
            "privateKey": {
              "type": "string",
              "description": "Generate a private key in GitHub App Settings.",
              "format": "textarea"
            }
          },
          "required": ["appId", "privateKey"],
          "additionalProperties": false,
          "description": "GitHub App related"
        },
        "userWhoCanRelease": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "github id of the user who can release"
        },
        "githubSecret": {
          "type": "string",
          "description": "此 webhook 的 secret. 你要在 GitHub 的 webhook 设置里面设置这个 secret"
        },
        "dingWebhooks": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/IDingWebhookItem"
          },
          "description": "需要推送通知的钉钉机器人的 webhook 地址"
        },
        "contentLimit": {
          "type": "number",
          "description": "通知的内容长度限制，超过这个长度的内容会被截断"
        },
        "isCommunity": {
          "type": "boolean",
          "description": "只推送内置的社区需要的那几个 event，event 列表见：https://github.com/opensumi/github-bot/blob/main/src/github/templates/index.ts#L25",
          "default": false
        },
        "event": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "监听哪些事件"
        },
        "notDisplayRepoName": {
          "type": "boolean",
          "description": "不在消息中展示 repo 名字，适合单仓库",
          "default": false
        },
        "installation": {
          "$ref": "#/definitions/IInstallationSetting",
          "description": "一般不需要配置这个，仅用于 OpenSumi 社区"
        }
      },
      "required": [
        "appSettings",
        "contentLimit",
        "dingWebhooks",
        "githubSecret"
      ]
    },
    "IDingWebhookItem": {
      "type": "object",
      "properties": {
        "url": {
          "type": "string",
          "description": "Webhook url"
        },
        "secret": {
          "type": "string",
          "description": "You should select **signed mode(加签模式)** in the security settings of the bot. and you will see the secret."
        },
        "event": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "哪些事件需要推送到这个 webhook，如：`release.released`。 不填写则推送所有事件"
        },
        "remark": {
          "type": "string",
          "description": "备注。你可以在这个空里备注下这个 webhook 是属于哪个群的。",
          "format": "textarea"
        }
      },
      "required": ["url", "secret"],
      "additionalProperties": false
    },
    "IInstallationSetting": {
      "type": "object",
      "properties": {
        "flags": {
          "type": "object",
          "additionalProperties": {
            "type": "number"
          }
        }
      },
      "required": ["flags"],
      "additionalProperties": false
    }
  }
}
